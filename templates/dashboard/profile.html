{% extends 'base.html' %}
{% load static %}

{% block title %}Profile • Sir Kothay?{% endblock %}

{% block body %}
<div class="pt-6 pb-20 md:pb-6 px-4 max-w-4xl mx-auto">

    <!-- Profile Header Card -->
    <div class="bg-white rounded-2xl shadow-lg overflow-hidden mb-8">
        <div class="bg-gradient-to-r from-green-500 to-emerald-600 h-32 md:h-40"></div>
        
        <div class="relative px-6 pb-8 pt-4 -mt-16 md:-mt-20">
            <div class="flex flex-col md:flex-row items-center md:items-end gap-6">
                <!-- Profile Picture -->
                <div class="relative">
                    {% if userd.get_image_url %}
                        <img src="{{ userd.get_image_url }}" alt="{{ username }}"
                             class="w-28 h-28 md:w-36 md:h-36 rounded-full border-4 border-white shadow-xl object-cover">
                    {% else %}
                        <div class="w-28 h-28 md:w-36 md:h-36 rounded-full border-4 border-white shadow-xl bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center text-white text-4xl md:text-5xl font-bold">
                            {{ username|slice:":2"|upper }}
                        </div>
                    {% endif %}
                </div>

                <!-- User Info -->
                <div class="text-center md:text-left flex-1">
                    <h1 class="text-3xl md:text-4xl font-bold text-gray-900">{{ username }}</h1>
                    <div class="flex flex-wrap items-center justify-center md:justify-start gap-3 mt-2 text-gray-600">
                        <span class="flex items-center gap-1"><i class="bi bi-envelope"></i> {{ user.email }}</span>
                        {% if userd.designation %}
                            <span class="text-gray-500">•</span>
                            <span class="flex items-center gap-1"><i class="bi bi-briefcase"></i> {{ userd.designation }}</span>
                        {% endif %}
                        {% if userd.organization %}
                            <span class="text-gray-500">•</span>
                            <span class="flex items-center gap-1"><i class="bi bi-building"></i> {{ userd.organization }}</span>
                        {% endif %}
                    </div>
                </div>

                <!-- Edit Button (Desktop) -->
                <div class="hidden md:block">
                    <button type="button" onclick="document.getElementById('profile-form').scrollIntoView({behavior: 'smooth'})"
                            class="px-6 py-3 bg-green-600 text-white font-medium rounded-xl hover:bg-green-700 transition shadow-lg">
                        <i class="bi bi-pencil-square mr-2"></i>Edit Profile
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Form Card -->
    <div id="profile-form" class="bg-white rounded-2xl shadow-lg p-6 md:p-10">
        <div class="flex items-center gap-3 mb-8">
            <div class="p-3 bg-green-100 rounded-xl">
                <i class="bi bi-person-gear text-2xl text-green-600"></i>
            </div>
            <div>
                <h2 class="text-2xl font-bold text-gray-900">Edit Profile</h2>
                <p class="text-gray-600">Update your personal information and preferences</p>
            </div>
        </div>

        <form method="POST" action="{% url 'user_details_update' %}" enctype="multipart/form-data" class="space-y-6">
            {% csrf_token %}

            <div class="grid md:grid-cols-2 gap-6">
                <!-- Username -->
                <div>
                    <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                        <i class="bi bi-person-circle text-green-600"></i> Full Name
                    </label>
                    <input type="text" name="username" value="{{ user.username }}" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition">
                </div>

                <!-- Email -->
                <div>
                    <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                        <i class="bi bi-envelope-fill text-green-600"></i> Email Address
                    </label>
                    <input type="email" name="email" value="{{ user.email }}" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition">
                </div>

                <!-- Phone -->
                <div>
                    <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                        <i class="bi bi-telephone-fill text-green-600"></i> Phone Number
                    </label>
                    <input type="text" name="phone_number" value="{{ userd.phone_number }}"
                           placeholder="+880 1XXX-XXXXXX"
                           class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition">
                </div>

                <!-- Designation -->
                <div>
                    <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                        <i class="bi bi-briefcase-fill text-green-600"></i> Designation
                    </label>
                    <input type="text" name="designation" value="{{ userd.designation }}"
                           placeholder="e.g. Student, Software Engineer"
                           class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition">
                </div>

                <!-- Organization -->
                <div>
                    <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                        <i class="bi bi-building-fill text-green-600"></i> Organization / University
                    </label>
                    <input type="text" name="organization" value="{{ userd.organization }}"
                           placeholder="e.g. United International University"
                           class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition">
                </div>

                <!-- Profile Image -->
                <div>
                    <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                        <i class="bi bi-image-fill text-green-600"></i> Profile Picture
                    </label>
                    <input type="file" name="profile_image" accept="image/*"
                           class="w-full px-4 py-3 border border-gray-300 rounded-xl file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-green-50 file:text-green-700 hover:file:bg-green-100 transition">
                </div>
            </div>

            <!-- Bio -->
            <div>
                <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                    <i class="bi bi-chat-quote-fill text-green-600"></i> Bio
                </label>
                <textarea name="bio" rows="4" placeholder="Tell us a little about yourself..."
                          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition resize-none">{{ userd.bio }}</textarea>
            </div>

            <!-- Submit Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200">
                <button type="submit"
                        class="flex-1 order-2 sm:order-1 px-8 py-4 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition shadow-lg transform hover:scale-105">
                    <i class="bi bi-check2-circle mr-2"></i>
                    Save Changes
                </button>
                <a href="{% url 'home' %}"
                   class="flex-1 text-center px-8 py-4 bg-gray-100 text-gray-700 font-medium rounded-xl hover:bg-gray-200 transition order-1 sm:order-2">
                    <i class="bi bi-arrow-left mr-2"></i>
                    Back to Dashboard
                </a>
            </div>
        </form>
    </div>

    <!-- Mobile Floating Edit Button -->
    <div class="md:hidden fixed bottom-20 right-6 z-40">
        <button onclick="document.getElementById('profile-form').scrollIntoView({behavior: 'smooth'})"
                class="bg-green-600 text-white p-4 rounded-full shadow-2xl hover:bg-green-700 transition transform hover:scale-110">
            <i class="bi bi-pencil-fill text-2xl"></i>
        </button>
    </div>
</div>
{% endblock %}